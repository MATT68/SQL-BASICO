
SELECT E.NUEMPL, E.NOMBRE AS EMPLEADO,  C.NOMBRE CONYUGE,  COALESCE(H.NOMBRE, 'SIN HIJOS') HIJO  
  FROM TEMPLA E INNER JOIN  CONYUGES C  
  ON E.NUEMPL = C.NUEMPL   
      JOIN HIJOS H   
      ON E.NUEMPL = H.NUEMPL;

SELECT NUEMPL, NOMBRE, FECHING, DAYNAME(FECHING) DIA, dayofweek(FECHING) 
FROM TEMPLA;

SELECT E.NUEMPL, E.NOMBRE, E.DEPT, D.NUMDIREC, JF.NOMBRE, A.AUMENTO   
  FROM TEMPLA E JOIN TDEPTA D  
  ON E.DEPT = D.NUMDEP  
      JOIN TEMPLA JF  
      ON JF.NUEMPL = D.NUMDIREC   
          LEFT JOIN AUMSAL A   
          ON A.nuempl = E.NUEMPL

SELECT NIVEDUC, COUNT(*) EMPLEADOS, AVG(SALARIO) AS MEDIA_SALARIO   
FROM TEMPLA
WHERE SALARIO > 12000
GROUP BY NIVEDUC
HAVING COUNT(*) > 1O
RDER BY AVG(SALARIO) DESC

-- SUBCONSULTAS NO CORRELACIONADAS
SELECT NUEMPL, NOMBRE, SALARIO   
    FROM TEMPLA  WHERE SALARIO > 
    ( SELECT AVG(SALARIO) FROM TEMPLA );

-- SUBCONSULTAS CORRELACIONADAS
SELECT NUEMPL, NOMBRE, SALARIO   
   FROM TEMPLA E  
   WHERE SALARIO > 
        ( SELECT AVG(SALARIO) FROM TEMPLA  
          WHERE DEPT = E.DEPT);

-- SUBCONSULTA BOOLEANA CORRELACIONADA
SELECT NUEMPL, NOMBRE, SALARIO   
  FROM TEMPLA E  
  WHERE SALARIO > 30000  
    AND EXISTS 
        ( SELECT 1 FROM AUMSAL     WHERE NUEMPL = E.NUEMPL )
        
