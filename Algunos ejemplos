
SELECT E.NUEMPL, E.NOMBRE AS EMPLEADO,  C.NOMBRE CONYUGE,  COALESCE(H.NOMBRE, 'SIN HIJOS') HIJO  
  FROM TEMPLA E INNER JOIN  CONYUGES C  
  ON E.NUEMPL = C.NUEMPL   
      JOIN HIJOS H   
      ON E.NUEMPL = H.NUEMPL;

SELECT NUEMPL, NOMBRE, FECHING, DAYNAME(FECHING) DIA, dayofweek(FECHING) 
FROM TEMPLA;

SELECT E.NUEMPL, E.NOMBRE, E.DEPT, D.NUMDIREC, JF.NOMBRE, A.AUMENTO   
  FROM TEMPLA E JOIN TDEPTA D  
  ON E.DEPT = D.NUMDEP  
      JOIN TEMPLA JF  
      ON JF.NUEMPL = D.NUMDIREC   
          LEFT JOIN AUMSAL A   
          ON A.nuempl = E.NUEMPL

SELECT NIVEDUC, COUNT(*) EMPLEADOS, AVG(SALARIO) AS MEDIA_SALARIO   
FROM TEMPLA
WHERE SALARIO > 12000
GROUP BY NIVEDUC
HAVING COUNT(*) > 1O
ORDER BY AVG(SALARIO) DESC

        --- SUBCONSULTAS    --------------------

  --- SUBCONSULTAS   NO CORRELACIONADAS --------------------

  SELECT VENDEDOR, NOMBRE, APELLIDO
  FROM VENDEDOR
  WHERE COMISION >  ( SELECT AVG(SALARIO)  
                       FROM  VENDEDOR );
 

  --- SUBCONSULTAS   CORRELACIONADAS --------------------

  SELECT VENDEDOR, NOMBRE, APELLIDO
  FROM VENDEDOR V
  WHERE COMISION >  ( SELECT AVG(SALARIO)  
                       FROM  VENDEDOR 
                       WHERE COM_AUTONOMA = V.COM_AUTONOMA );
                       
-- SUBCONSULTA BOOLEANA CORRELACIONADA

SELECT NUEMPL, NOMBRE, SALARIO   
  FROM TEMPLA E  
  WHERE SALARIO > 30000  
    AND EXISTS 
        ( SELECT 1 FROM AUMSAL     WHERE NUEMPL = E.NUEMPL );
        
   --- SUBCONSULTAS   ESCALARES --------------------

  SELECT VENDEDOR, NOMBRE, APELLIDO, ( SELECT AVG(SALARIO)  
                                       FROM  VENDEDOR  ) SAL_MEDIO
  FROM VENDEDOR V
  WHERE .... ;


  --- QUERY ANIDADA OR NESTED QUERIES  --------------------

  SELECT APELLIDO, COUNT(*)
  FROM ( 
      SELECT  NOMBRE,  APELLIDO, TLF_MV , E_MAIL
      FROM VENDEDOR
          UNION  
      SELECT  NOMBRE, APELLIDO, TLF_MV , E_MAIL
      FROM CLIENTE
       ) TAB_NUEVA 
  GROUP BY TAB_NUEVA.APELLIDO  ;

  
  --  AQR :  Automatic Query Rewrite

  -- FULLSELECT con los MULTISET OPERATORs

      SELECT  NOMBRE, APELLIDO, TLF_MV , E_MAIL
      FROM VENDEDOR
    UNION  [ALL] /  MINUS-EXCEPT / INTERSECT
      SELECT  NOMBRE, APELLIDO, TLF_MV , E_MAIL
      FROM CLIENTE
    ORDER BY APELLIDO, NOMBRE ;  
        
